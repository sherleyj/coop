(this.webpackJsonpcoop=this.webpackJsonpcoop||[]).push([[0],{18:function(e,a,t){},44:function(e,a,t){e.exports=t(77)},49:function(e,a,t){},59:function(e,a){},61:function(e,a){},77:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(41),c=t.n(l),o=(t(49),t(6)),s=(t(18),t(11)),u=Object(n.createContext)(),i=function(e){var a=Object(n.useState)({}),t=Object(o.a)(a,2),l=t[0],c=t[1];return r.a.createElement(u.Provider,{value:[l,c]},e.children)};var m=function(){var e=Object(n.useContext)(u),a=Object(o.a)(e,2),t=a[0];return a[1],console.log("FROM NAV, game.gameid: ",t.gameId),t.gameId?r.a.createElement("nav",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("h3",null,"Home")),r.a.createElement(s.b,{to:"/".concat(t.gameId)},r.a.createElement("h3",null,t.gameId))):r.a.createElement("nav",null,r.a.createElement(s.b,{to:"/"},r.a.createElement("h3",null,"Home")),r.a.createElement(s.b,{to:"/${}"},r.a.createElement("h3",null)))},p=t(1),d=t.n(p),b=t(2),h=t(3),E=t(9),v=t(4),g=function(e,a){var t=Object(n.useRef)();Object(n.useEffect)((function(){t.current=e}),[e]),Object(n.useEffect)((function(){if(null!==a){var e=setInterval((function(){t.current()}),a);return function(){return clearInterval(e)}}}),[a])},f=function(e,a){return a.reduce((function(e,a){return e&&"undefined"!==e[a]?e[a]:void 0}),e)};t(55);var y=function(){var e=Object(v.g)().gameidURL;console.log("FROM COOP gameidURL: ",e);var a=Object(n.useContext)(u),t=Object(o.a)(a,2),l=t[0],c=t[1];console.log("first to render in COOP, gameidURL: ",e),Object(n.useEffect)((function(){console.log("PLAYER: game not set, grabbing it! ",e),i()}),[]);var i=function(){var a=Object(E.a)(d.a.mark((function a(){var t,n;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,console.log("getting game"),a.next=4,fetch("/api/getGame/"+e);case 4:return t=a.sent,console.log("lalala"),a.next=8,t.json();case 8:n=a.sent,console.log("game from api:",n),c(Object(h.a)(Object(h.a)({},n),{},{players:Object(b.a)(n.players),characters:Object(b.a)(n.characters)})),console.log("GETGAME, gameFromAPI:",n),a.next=18;break;case 14:return a.prev=14,a.t0=a.catch(0),console.log("Exception caught: ",a.t0),a.abrupt("return",r.a.createElement("div",null,"Error: ",a.t0.message));case 18:case"end":return a.stop()}}),a,null,[[0,14]])})));return function(){return a.apply(this,arguments)}}(),m="";return l.players&&(m=l.players.map((function(a){var t="",n=a.id+1,c=a.characters[0],o=a.characters[1],u="",i="",m=!a.active;c.active||(console.log("character 0 dead.",l.characters[c.id].name),u=l.characters[c.id].name),o.active||(console.log("character 1 dead."),i=l.characters[o.id].name),a.turn&&(t="Your turn!");var p="/"+e+"/player/"+n;return m?r.a.createElement("div",null,r.a.createElement("div",{key:a.id,className:"player"}," ",r.a.createElement(s.b,{to:p},"Player ",n),r.a.createElement("span",null," DEAD "),r.a.createElement("p",null,"Num coins: ",a.coins),r.a.createElement("span",null,u," "),r.a.createElement("span",null,i," "),r.a.createElement("br",null),"--------------------------------")):r.a.createElement("div",null,r.a.createElement("div",{key:a.id,className:"player"}," ",r.a.createElement(s.b,{to:p},"Player ",n),r.a.createElement("span",null," ",t),r.a.createElement("p",null,"Num coins: ",a.coins),r.a.createElement("span",null,u," "),r.a.createElement("span",null,i," "),r.a.createElement("br",null),"--------------------------------"))}))),g(Object(E.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),7e3),r.a.createElement("div",null,r.a.createElement("h1",null,"Game Page for ",e),r.a.createElement("p",null,l.numPlayers),m)},O=t(43);var j=function(){console.log("****** new render ******");var e=Object(v.g)(),a=e.gameidURL,t=e.playeridURL,l=t-1,c=Object(n.useContext)(u),s=Object(o.a)(c,2),i=s[0],m=s[1],p=Object(n.useState)(0),y=Object(o.a)(p,2),j=y[0],k=y[1],x=Object(n.useState)([]),C=Object(o.a)(x,2),P=C[0],S=C[1],I=Object(n.useState)(0),T=Object(o.a)(I,2),w=T[0],A=T[1],N=Object(n.useState)([!1,!1,!1,!1]),D=Object(o.a)(N,2),L=D[0],R=D[1],Y=Object(n.useState)(0),U=Object(o.a)(Y,2),H=U[0],J=U[1];Object(n.useEffect)((function(){console.log("PLAYER: game not set, grabbing it! ",a),B()}),[]);var B=function(){var e=Object(E.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/getGame/"+a);case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,m(Object(h.a)(Object(h.a)({},n),{},{players:Object(b.a)(n.players),characters:Object(b.a)(n.characters)})),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();function G(e){console.log("*** ACTION CHOSEN");var a=e.target.name;i.actionTaken=a,F(a)}console.log(P);var F=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.players[l].turn||i.challenge){e.next=23;break}return n={},console.log("ACTION: ",t),n="steal"==t||"coop"==t||"exchange"==t||"assassinate"==t&&P?{gameId:a,playerId:l,action:t,actOnId:P}:{gameId:a,playerId:l,action:t,actOnId:[]},console.log("POST takeTurn ",n),e.prev=5,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=9,fetch("/api/takeTurn",c);case 9:return o=e.sent,e.next=12,o.json();case 12:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),console.log("game from API:"),console.log(s),console.log(i),e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(5),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 23:case"end":return e.stop()}}),e,null,[[5,19]])})));return function(a){return e.apply(this,arguments)}}(),M=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ke){e.next=18;break}return n={gameId:a,playerId:l},console.log("POST: ",n),e.prev=3,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=7,fetch("/api/challenge",c);case 7:return o=e.sent,e.next=10,o.json();case 10:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(a){return e.apply(this,arguments)}}(),K=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={gameId:a,playerId:l},console.log("POST: ",n),e.prev=2,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=6,fetch("/api/challengeBlock",c);case 6:return o=e.sent,e.next=9,o.json();case 9:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(a){return e.apply(this,arguments)}}(),W=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!xe){e.next=18;break}return n={gameId:a,playerId:l},console.log("POST: ",n),e.prev=3,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=7,fetch("/api/block",c);case 7:return o=e.sent,e.next=10,o.json();case 10:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(a){return e.apply(this,arguments)}}(),$=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ke&&!xe){e.next=17;break}return n={gameId:a,playerId:l},e.prev=2,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=6,fetch("/api/pass",c);case 6:return o=e.sent,e.next=9,o.json();case 9:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(a){return e.apply(this,arguments)}}(),V=function(){var e=Object(E.a)(d.a.mark((function e(t){var n,c,o,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ke&&!xe){e.next=17;break}return n={gameId:a,playerId:l,characterToLose:t},e.prev=2,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)},e.next=6,fetch("/api/loseCharacter",c);case 6:return o=e.sent,e.next=9,o.json();case 9:s=e.sent,m(Object(h.a)(Object(h.a)({},s),{},{players:Object(b.a)(s.players),characters:Object(b.a)(s.characters)})),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(2),console.log(e.t0),e.abrupt("return",r.a.createElement("div",null,"Error: ",e.t0.message));case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(a){return e.apply(this,arguments)}}();function q(e,a){return a.reduce((function(e,a){return e&&"undefined"!==e[a]?e[a]:void 0}),e)}function z(e){e.preventDefault(),k(e.target.value),console.log("handleChooseCharChange, e.target.value ",e.target.value,"choosecharid: ",j)}function Q(e){A(e.target.value),console.log("in handleActOnChange actOnId[0]",w),console.log("actOnId[0] == e.target.value ",w==e.target.value)}function X(e){e.preventDefault(),P[0]=w,S(P),console.log("in handleActOnSubmit, actOnId: ",P),F(e.target.name),S([])}function Z(e){console.log("game.players[playerid].influence: ",i.players[l].influence);var a=!L[e.target.name];console.log("****HANDLE CHANGE numSelected: ",H),H<i.players[l].influence&&a&&(console.log("CHECK!"),L[e.target.name]=!L[e.target.name],R(L),J(H+1)),a||(console.log("UNCHECK!"),L[e.target.name]=!L[e.target.name],R(L),J(H-1)),console.log(L)}for(var _=f(i,["players",l,"coins"]),ee=f(i,["players",l,"active"]),ae=f(i,["players",l,"turn"])?"Your turn!":"",te=f(i,["players",l,"losePlayer"]),ne=!(!ae||"steal"!=i.actionTaken),re=!(!ae||"coop"!=i.actionTaken),le=!(!ae||"exchange"!=i.actionTaken),ce=!(!ae||"assassinate"!=i.actionTaken),oe=f(i,["players",l,"passed"]),se=f(i,["players",l,"challenge"]),ue=_>6,ie=!(""===i.blockedBy||!ae),me=f(i,["players",l,"characters",0,"id"]),pe=f(i,["players",l,"characters",1,"id"]),de=f(i,["characters",me,"name"]),be=f(i,["characters",pe,"name"]),he=f(i,["players",l,"characters",0,"active"]),Ee=f(i,["players",l,"characters",1,"active"]),ve=!!f(i,["players",l,"actionTaken"]),ge=new Array(i.numPlayers),fe=0;fe<i.numPlayers;fe++)ge[fe]=!!q(i,["players"])&&q(i,["characters",me,"name"]);var ye="";i.players&&(ye=i.players.map((function(e,a){if(a!=l&&e.coins>0&&e.active)return r.a.createElement("div",null,r.a.createElement("input",{type:"radio",value:e.id,checked:w==e.id,key:e.id,onChange:Q})," ",e.id+1)})));var Oe="";i.players&&(Oe=i.players.map((function(e,a){if(a!=l&&e.active)return r.a.createElement("div",null,r.a.createElement("input",{type:"radio",value:e.id,checked:w==e.id,key:e.id,onChange:Q})," ",e.id+1)})));var je="";i.players&&(je=i.players[i.pTurnId].characters.map((function(e,a){if(e.active)return r.a.createElement("div",null,r.a.createElement("input",{type:"checkbox",name:a,value:e.id,checked:L[a],key:a,onChange:Z})," ",i.characters[e.id].name);a+=1})));for(var ke=["tax","assassinate","steal","exchange","block"].includes(i.actionTaken),xe=["aid","steal","assassinate"].includes(i.actionTaken),Ce=!1,Pe=0;Ce&&Pe<i.numPlayers;)if(1==q(i,["players",Pe,"losePlayer"])){Object(O.a)("someoneLosePlayer"),Ce=!0,Pe+=1;break}return g(Object(E.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!ae||ae&&i.challenge)){e.next=4;break}return e.next=3,B();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),5e3),console.log(i),console.log("exchanging: ",le),ee?!le||P.length||i.challenge?te&&he&&Ee?r.a.createElement("div",null,r.a.createElement("div",null,"HEY YOU LOSE A PLAYER!"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),k(e.target.value),console.log("^^^^^^^^^^^^^^^^^^^^^^^^^ ",j),V(j)}},r.a.createElement("input",{type:"radio",value:"0",name:de,checked:0==j,onChange:z})," ",de,r.a.createElement("input",{type:"radio",value:"1",name:be,checked:1==j,onChange:z})," ",be,r.a.createElement("button",{className:"btn btn-default",type:"submit"},"Submit"))):ne&&i.players[0].characters[0]&&!i.challenge?r.a.createElement("div",null,r.a.createElement("div",null,"Pick a Player to Steal From: "),r.a.createElement("form",{onSubmit:X,name:"steal"},ye,r.a.createElement("button",{className:"btn btn-default",type:"submit"},"Submit"))):!ce||i.actOnId.length||i.challenge?re&&i.players[0].characters[0]&&!i.challenge?r.a.createElement("div",null,r.a.createElement("div",null,"Pick a Player to Coop: "),r.a.createElement("form",{onSubmit:X,name:"coop"},Oe,r.a.createElement("button",{className:"btn btn-default",type:"submit"},"Submit"))):!ae||i.challenge||i.actionTaken?i.challenge&&!ae?r.a.createElement("div",null,r.a.createElement("h1",null,"Player Page ",t," "),r.a.createElement("h2",null,"You have ",_," coins "),r.a.createElement("span",null,"Challenge/Counteraction/Pass")," ",r.a.createElement("br",null),r.a.createElement("button",{onClick:M,disabled:!ke||se||oe},"Challenge"),r.a.createElement("button",{onClick:W,disabled:!xe||se||oe},"Block"),r.a.createElement("button",{onClick:$,disabled:oe||se},"Pass"),r.a.createElement("h2",null,"Characters"),r.a.createElement("div",null,de," ",he?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "),r.a.createElement("div",null,be," ",Ee?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," ")):i.challenge&&ae&&ie?r.a.createElement("div",null,r.a.createElement("h1",null,"Player Page ",t," "),r.a.createElement("h2",null,"You have ",_," coins "),r.a.createElement("span",null,"Challenge or Pass the Block")," ",r.a.createElement("br",null),se||oe?null:r.a.createElement("button",{onClick:K},"Challenge"),oe?null:r.a.createElement("button",{onClick:$},"Pass"),r.a.createElement("h2",null,"Characters"),r.a.createElement("div",null,de," ",he?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "),r.a.createElement("div",null,be," ",Ee?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," ")):r.a.createElement("div",null,r.a.createElement("h1",null,"Player Page ",t," "),r.a.createElement("h2",null,"You have ",_," coins "),r.a.createElement("h2",null,"Characters"),r.a.createElement("div",null,de," ",he?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "),r.a.createElement("div",null,be," ",Ee?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," ")):r.a.createElement("div",null,r.a.createElement("h1",null,"Player Page ",t," "),r.a.createElement("h2",null,"You have ",_," coins "),r.a.createElement("button",{onClick:G,name:"income",disabled:ve},"Collect Income"),r.a.createElement("button",{onClick:G,name:"aid",disabled:ve},"Collect Foreign Aid"),r.a.createElement("button",{onClick:G,name:"tax",disabled:ve},"Collect Tax"),r.a.createElement("button",{onClick:G,name:"exchange",disabled:ve},"Exchange"),r.a.createElement("button",{onClick:G,name:"steal",disabled:ve},"Steal"),r.a.createElement("button",{onClick:G,name:"assassinate",disabled:ve||_<3},"Assassinate"),r.a.createElement("button",{onClick:G,name:"coop",disabled:!ue||ve},"Coop!"),r.a.createElement("h2",null,"Characters"),r.a.createElement("div",null,de," ",he?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "),r.a.createElement("div",null,be," ",Ee?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," ")):r.a.createElement("div",null,r.a.createElement("div",null,"Pick a Player to Assassinate: "),r.a.createElement("form",{onSubmit:X,name:"assassinate"},Oe,r.a.createElement("button",{className:"btn btn-default",type:"submit"},"Submit"))):r.a.createElement("div",null,r.a.createElement("div",null,"Pick ",i.players[i.pTurnId].influence," cards to keep:"),r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),H!=i.players[l].influence){var a="Must select "+i.players[l].influence+" cards.";return alert(a),!1}L.forEach((function(e,a){e&&S(P.push(i.players[l].characters[a].id))})),console.log("IN Submit, actOnId:",P),F("exchange"),S([])},name:"exchange"},je,r.a.createElement("button",{className:"btn btn-default",type:"submit"},"Submit"))):r.a.createElement("div",null,r.a.createElement("h1",null,"Player Page ",t," "),r.a.createElement("h2",null,"You have are DEAD "),r.a.createElement("h2",null,"Characters"),r.a.createElement("div",null,de," ",he?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "),r.a.createElement("div",null,be," ",Ee?r.a.createElement("span",null,"- Active"):r.a.createElement("span",null,"- Dead")," "))};function k(){var e=Object(n.useState)("this-is-my-game"),a=Object(o.a)(e,2),t=a[0],l=a[1],c=Object(n.useContext)(u),s=Object(o.a)(c,2),i=(s[0],s[1],Object(v.f)());return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i.push("".concat(t))}},r.a.createElement("input",{type:"text",value:t,onChange:function(e){l(e.target.value)}}))}var x=function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(s.a,null,r.a.createElement(v.c,null,r.a.createElement(i,null,r.a.createElement(m,null),r.a.createElement(v.a,{path:"/",exact:!0,component:k}),r.a.createElement(v.a,{path:"/:gameidURL",exact:!0},r.a.createElement(y,null)),r.a.createElement(v.a,{path:"/:gameidURL/player/:playeridURL"},r.a.createElement(j,null))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,1,2]]]);
//# sourceMappingURL=main.0d8e66da.chunk.js.map